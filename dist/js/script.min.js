(()=>{"use strict";async function e(){const e=await fetch("https://jsonplaceholder.typicode.com/users");try{if(e.ok)return await e.json();console.log("Ошибка HTTP "+e.status)}catch(e){console.log("Ошибка при выполнении запроса "+e.message)}}async function t(){const e=await fetch("https://jsonplaceholder.typicode.com/posts");try{if(e.ok)return await e.json();console.log("Ошибка HTTP "+e.status)}catch(e){console.log("Ошибка при выполнении запроса "+e.message)}}e(),t();const s=document.querySelector(".container"),o=document.createElement("div"),n=document.createElement("form"),a=document.createElement("h2"),l=document.createElement("input"),c=document.createElement("input"),d=document.createElement("input"),r=document.createElement("input"),i=document.createElement("button");function p(e){const t=document.createElement("div");t.classList.add("post__card"),t.innerHTML=`\n        <h2 class="post__title">${e.title}</h2>\n        <p class="post__text">${e.body}</p>\n        <p class="post__data-user">${e.data}</p>\n        <p class="post__email">${e.email}</p>\n    `,o.insertBefore(t,o.firstChild);const s=document.createElement("button");s.innerText="Delete Post",s.setAttribute("data-id",e.id),s.addEventListener("click",(()=>{const e=s.getAttribute("data-id");fetch(`https://jsonplaceholder.typicode.com/posts/${e}`,{method:"DELETE"}).then((e=>{if(!e.ok)throw new Error("Ошибка удаления поста");return e.json()})).then((e=>{t.remove()})).catch((e=>{console.error(e)}))})),t.appendChild(s)}document.createElement("button"),function(){n.classList.add("post__create-form"),s.appendChild(n),a.classList.add("post__titleForm"),a.textContent="Add your post",n.appendChild(a),l.classList.add("post__input-title"),n.appendChild(l),l.placeholder="Enter post title",l.type="text",c.classList.add("post__input-body"),n.appendChild(c),c.placeholder="Enter post",c.type="text",d.classList.add("post__input-data"),n.appendChild(d),d.placeholder="Enter your full name",d.type="text",r.classList.add("post__input-email"),n.appendChild(r),r.placeholder="Enter your email",r.type="text",i.textContent="Add new post",i.classList.add("post__submit"),i.type="submit",n.appendChild(i);let e=[];i.addEventListener("submit",(t=>{t.preventDefault(),fetch("https://jsonplaceholder.typicode.com/posts",{method:"POST",body:JSON.stringify({title:l.value,body:c.value,data:d.value,email:r.value,userId:1}),headers:{"Content-type":"application/json; charset=UTF-8"}}).then((e=>e.json())).then((t=>{e.push(t),p(t)}))}))}(),i.addEventListener("click",(e=>{e.preventDefault();let t=l.value,s=c.value,o=d.value,n=r.value;const a=document.querySelectorAll("input");if(a.forEach((e=>{const t=e.parentNode,s=t.querySelector(".message");if(""===e.value){if(e.style.border="2px solid red",!s){const e=document.createElement("div");e.classList.add("message"),e.textContent="Please fill in all fields correctly",e.style.fontSize="23px",e.style.color="red",t.appendChild(e)}}else e.style.border="2px solid #ccc",s&&t.removeChild(s)})),0!==Array.from(a).filter((e=>""===e.value)).length)return!1;const i=r.parentNode,u=i.querySelector(".message");if(!function(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())}(n)){if(r.style.border="2px solid red",!u){const e=document.createElement("div");e.classList.add("message"),e.textContent="Please enter a valid email address",e.style.fontSize="23px",e.style.color="red",i.appendChild(e)}return!1}return r.style.border="1px solid #ccc",u&&i.removeChild(u),p({title:t,body:s,data:o,email:n,userId:1}),!0})),function(e){const t=new Image;t.onload=t.onerror=function(){1==(2==t.height)?document.querySelector("html").classList.add("webp"):document.querySelector("html").classList.add("no-webp")},t.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}(),Promise.all([e(),t()]).then((e=>{const[t,n]=e;!function(e,t){o.classList.add("post"),s.appendChild(o);const n=e.slice(0,10),a=t.slice(0,10);a.forEach(((e,t)=>{const s=n[t],l=document.createElement("div");l.classList.add("post__card"),l.innerHTML=`\n            <h2 class="post__title">${e.title}</h2>\n            <p class="post__text">${e.body}</p>\n            <p class="post__data-user">${s.name}</p>\n            <p class="post__email">${s.email}</p>\n        `;const c=document.createElement("button");c.innerText="Delete Post",c.setAttribute("data-id",e.id),c.classList.add("post__deleteBtn"),c.addEventListener("click",(()=>{const e=c.getAttribute("data-id");fetch(`https://jsonplaceholder.typicode.com/posts/${e}`,{method:"DELETE"}).then((e=>{if(!e.ok)throw new Error("Ошибка удаления поста");return e.json()})).then((e=>{a.splice(t,1),l.remove()})).catch((e=>{console.error(e)}))})),l.appendChild(c),o.appendChild(l)}))}(t,n)})).catch((e=>console.log(e)))})();